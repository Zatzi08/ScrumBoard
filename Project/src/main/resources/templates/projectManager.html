<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projektmanager</title>
    <link rel="stylesheet" href="/css/foundation.css">
    <link rel="stylesheet" href="/css/projectManager.css">
    <link rel="stylesheet" href="/css/setup.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>
<body>
<!--
       Author: Zana Salih Hama
       Revisited: /
       Funktion: Reiter zur Übersicht aller Seiten[-optionen]
       Grund: Übersichtlichkeit
       User-ID/Task-ID: /
    -->
<div class="Reiter">
    <button class="reiterBtn" onmouseover = "hover('reiterBtn')" onmouseleave="hoverLeave('reiterBtn')" id = "pjBtn" style = "border-bottom: 1px solid #ffffff;">Projekt Manager</button>
    <button type="button"  th:Sid="${sessionID}" onclick="SwitchToOwnProfile(this.getAttribute('Sid'))" class = "reiterBtn">Profil </button>
    <button class = "reiterBtn" th:Sid="${sessionID}" onclick="SwitchToTaskBoard(this.getAttribute('Sid'))">Task-Board </button>
    <button class = "reiterBtn">Kalender </button>
    <button class = "reiterBtn" style="margin-left: auto; margin-right: 0;"><a href="/">Abmelden</a></button>
</div>

<div id="outerProjectManagerContainer">
    <div id="Hi">
        <button class="selectBtn" id="selectUserstory" onmouseover = "hover('selectUserstory')" onmouseleave="hoverLeave('selectUserstory')" style= "border-bottom: 1px solid #ffffff" title="Wechsel Ansicht zu Userstories">Userstories</button>
        <span class="userStoryTaskTrenner">|</span>
        <button class="selectBtn" id="selectTasks" th:Sid="${sessionID}" onclick="SwitchToTasks(this.getAttribute('Sid'))" onmouseover = "hover('selectTasks')" onmouseleave="hoverLeave('selectTasks')" title="Wechsel Ansicht zu Tasks">Tasks</button>
        <span class="userStoryTaskTrenner">|</span>
        <button class="selectBtn" id="selectUser" th:Sid="${sessionID}" onclick="SwitchToUsers(this.getAttribute('Sid'))" title = "Wechsel zur Nutzeransicht">Nutzer</button>
        <button class="addUserStoryBtn" title="Füge eine Userstory hinzu" onclick="toggleEditBox('addUserStoryBtn', -1)"><i class="fa fa-plus" style="margin-right: 10px"></i>Userstory erstellen</button>
    </div>
        <div id="innerProjectManagerContainer">
        <div class="wrapper">
            <table class="userTaskTable">
                <thead id="userTaskTableHead">
                    <tr>
                        <th id = "tableHeader" style="cursor: default">Userstories <button type="button" id="visAllTasks" th:unless="${Storys.isEmpty()}" th:est="${Storys.get(0).getAnforderungenG()}" th:real="${Storys.get(0).getAnforderungenA()}" th:names="${TNames}" onclick="visualisationOfAllTimes(this.getAttribute('est'), this.getAttribute('real'), this.getAttribute('names'))" title="Schätzungstracker für alle Tasks"><i class="fa-solid fa-chart-bar" style="color: white"></i></button></th>
                    </tr>
                </thead>
                <tbody id="userTaskTableBody">
                    <tr th:each="item : ${Storys}" th:USid="${item.ID}" th:Sid="${sessionID}"  ondblclick="SwitchToTasksbyUSID(this.getAttribute('Sid'), this.getAttribute('USid'))">
                        <th style="cursor: alias" title="Doppelklick, um auf Tasks zur Userstory zu gelangen">
                            <div class="buttonBox">
                                <button id="Btn1" title="Bearbeiten" th:sname="${item.name}" th:sdescription="${item.description}" th:sid="${item.ID}" th:prio="${item.getPriorityAsInt()}" onclick="toggleEditBox('editBtn', this.getAttribute('sid'), this.getAttribute('sname'), this.getAttribute('sdescription'), this.getAttribute('prio'));" ><i class="fa fa-edit"></i></button>
                                <button id="Btn2" th:USid="${item.ID}" th:Sid="${sessionID}" onclick="deleteUS(this.getAttribute('USid'),this.getAttribute('Sid'))" title="Löschen">&times;</button>
                            </div>
                            <br/>
                            <i class="fa-solid fa-file-lines" id="iContent1"></i><label class="iContent-Label" style="margin-left: 14.7px; font-size: 16px">Titel</label>
                            <label class = "userTaskTableBody-Content" th:text = "${item.name}" title="Titel der User-Story">Name</label>
                            <i class="fa-solid fa-circle-exclamation" id="iContent2"></i><label class="iContent-Label">Priorität</label><label class = "userTaskTableBody-Content" th:text = "${item.priority}" title="Priorität der User-Story">Priorität</label>
                            <p class="userTaskTableBody-Border"></p>
                            <i class = "fa-solid fa-bars" id="iContent3"></i><label class="iContent-Label">Beschreibung</label><label class = "userTaskTableBody-Content" title="Beschreibung der User-Story" th:text="${item.description}">Beschreibung</label>
                        </th>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<!--
           Author: Zana Salih Hama
           Revisited: /
           Funktion: Bearbeitungs-/Erstellungsfenster für User-Stories
           Grund: /
           User-ID/Task-ID: U3.F1, U4.F1, U5.F1, U5.F2
-->
<div class = "editMenu" style="width: 560px; height: 340px;">
    <label style="color: white; border-bottom: 1px solid #ffffff; margin-bottom: 20px">Bearbeitungsmenü</label>
    <span id="closeToggleEdit" class="closeToggleEdit" onclick="toggleEditMenu()">&times;</span>
    <div class="editMenu-content">
        <form class="form"  method="post" id="editForm" autocomplete="off" name="Story">
            <textarea id="inputName" class="inputEdit" required placeholder="Titel der User-Story eingeben" name="name" form="editForm"></textarea>
            <textarea id="inputDesc" class="inputEdit" required placeholder="Eine passende Beschreibung eingeben" name="description" form="editForm"></textarea>
            <label>Priorität</label>
            <button type="button" class="inputEditPrio" id="inputPrioUrgent" onclick="highlightPriorityButton('inputPrioUrgent')" style="background-color: #f76c5e" name="urgent" form="editForm">Urgent</button>
            <button type="button" class="inputEditPrio" id="inputPrioHigh" onclick="highlightPriorityButton('inputPrioHigh')" style="background-color: #f68e5f" name="high" form="editForm">High</button>
            <button type="button" class="inputEditPrio" id="inputPrioNormal" onclick="highlightPriorityButton('inputPrioNormal')" style="background-color: #f5dd90" name="normal" form="editForm">Normal</button>
            <button type="button" class="inputEditPrio" id="inputPrioLow" onclick="highlightPriorityButton('inputPrioLow')" style="background-color: #9EC5E5" name="low" form="editForm">Low</button>
            <label style="margin-top: 15px"> </label>
            <input type="hidden" id = "editId" name="id" value="-1">
            <input type="hidden" id = "editPrio" name="priority" value="1">
            <button type="button" th:sessionID="${sessionID}" onclick="saveUS(this,this.getAttribute('sessionID'))" id="editMenu-saveEditBtn">Speichern</button>
        </form>
    </div>
</div>

<div id = "visEstimateTracker">
    <div id = "visEstimateTracker-graph">
        <canvas id = "myChart2"></canvas>
    </div>
    <label id="percentageDifferenceText"></label>
</div>
    <script src="/js/vendor/jquery.js"></script>
    <script src="/js/vendor/what-input.js"></script>
    <script src="/js/vendor/foundation.js"></script>
    <script src="/js/app.js"></script>
    <script src="/js/communication.js"></script>
    <script type = "text/javascript" src="/js/setup.js"></script>
    <script src="/js/projectManager.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module" src="/js/myChart.js"></script>
    <script src="/js/myChart.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/@stomp/stompjs@7.0.0/bundles/stomp.umd.min.js"></script>
    <script src="/js/webSockets/websocket.js"></script>
    <script src="/js/webSockets/WS_PM_US.js"></script>
    <script type="application/javascript">
        window.onbeforeunload = disconnect();
        window.onload = connect();
    </script>
</body>
</html>